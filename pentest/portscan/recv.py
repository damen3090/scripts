#! /usr/bin/env python
from scapy.all import *

# http://biot.com/capstats/bpf.html
# http://www.freebuf.com/sectool/94507.html

whitelist = ['127.0.0.1']

f="tcp[tcpflags] & tcp-syn != 0 and tcp[tcpflags] & tcp-ack != 0"

def callback(pkt):
	#pkt.show()
	if pkt[IP].src in whitelist:
		print "%s:%s"%(pkt[IP].src, pkt[TCP].sport)

sniff(prn=callback, filter=f, store=0)